# üéì UAI_FT_vs_RAG

–°—Ä–∞–≤–Ω–µ–Ω–∏–µ **Fine-tuning** –∏ **RAG** –¥–ª—è –æ–¥–Ω–æ–π –∏ —Ç–æ–π –∂–µ –º–æ–¥–µ–ª–∏ OpenAI (`gpt-4o-mini-2024-07-18`)  
–≤ —Ä–∞–º–∫–∞—Ö –∫—É—Ä—Å–∞ **–£–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç–∞ –∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç–∞**.

> üí° –£—á–µ–±–Ω—ã–π –ø—Ä–æ–µ–∫—Ç –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç —É–º–µ–Ω–∏–µ –¥–æ–æ–±—É—á–∞—Ç—å –º–æ–¥–µ–ª–∏ (Fine-tuning)  
> –∏ —Ä–µ–∞–ª–∏–∑–æ–≤—ã–≤–∞—Ç—å Retrieval-Augmented Generation (RAG) –Ω–∞ –æ–¥–Ω–æ–º –∏ —Ç–æ–º –∂–µ –¥–∞—Ç–∞—Å–µ—Ç–µ.  
> –ú–æ–¥–µ–ª—å –æ–±—É—á–µ–Ω–∞ —Ç–∞–∫, —á—Ç–æ–±—ã –Ω–µ —Ç–æ–ª—å–∫–æ –æ—Ç–≤–µ—á–∞—Ç—å –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã –æ–± –æ–±—É—á–µ–Ω–∏–∏ –≤ –£–ò–ò,  
> –Ω–æ –∏ –º—è–≥–∫–æ –º–æ—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø—Ä–∏–æ–±—Ä–µ—Å—Ç–∏ –ø–ª–∞—Ç–Ω—ã–µ –∫—É—Ä—Å—ã.

---

## üìö –¶–µ–ª—å –ø—Ä–æ–µ–∫—Ç–∞
–°—Ä–∞–≤–Ω–∏—Ç—å –¥–≤–∞ –ø–æ–¥—Ö–æ–¥–∞ –∞–¥–∞–ø—Ç–∞—Ü–∏–∏ —è–∑—ã–∫–æ–≤—ã—Ö –º–æ–¥–µ–ª–µ–π:

1. **Fine-tuning** ‚Äî –¥–æ–æ–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ –ø–æ–¥ –Ω—É–∂–Ω—ã–π —Å—Ç–∏–ª—å –∏ –∑–∞–¥–∞—á–∏.  
2. **RAG (Retrieval-Augmented Generation)** ‚Äî –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –≤–Ω–µ—à–Ω–µ–π –±–∞–∑—ã –∑–Ω–∞–Ω–∏–π –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å–∞–º–æ–π –º–æ–¥–µ–ª–∏.

–û–±–µ –≤–µ—Ä—Å–∏–∏ –º–æ–¥–µ–ª–∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω—ã –Ω–∞ 5 –æ–¥–∏–Ω–∞–∫–æ–≤—ã—Ö –≤–æ–ø—Ä–æ—Å–æ–≤, –∫–∞—Å–∞—é—â–∏—Ö—Å—è –æ–±—É—á–µ–Ω–∏—è –≤ –£–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç–µ –ò–ò.

---

## ‚öôÔ∏è –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

UAI_FT_vs_RAG/
‚îÇ
‚îú‚îÄ‚îÄ data/ # –ò—Å—Ö–æ–¥–Ω—ã–π –¥–∞—Ç–∞—Å–µ—Ç –∏ –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã
‚îÇ ‚îú‚îÄ‚îÄ uai_dataset.csv
‚îÇ ‚îú‚îÄ‚îÄ ft_train.jsonl
‚îÇ ‚îî‚îÄ‚îÄ rag_corpus.csv
‚îÇ
‚îú‚îÄ‚îÄ finetune/ # –î–æ–æ–±—É—á–µ–Ω–∏–µ –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ fine-tuned –º–æ–¥–µ–ª–∏
‚îÇ ‚îú‚îÄ‚îÄ train.py
‚îÇ ‚îî‚îÄ‚îÄ test.py
‚îÇ
‚îú‚îÄ‚îÄ rag/ # –†–µ–∞–ª–∏–∑–∞—Ü–∏—è RAG-–ø–∞–π–ø–ª–∞–π–Ω–∞
‚îÇ ‚îú‚îÄ‚îÄ pipeline.py
‚îÇ ‚îî‚îÄ‚îÄ test.py
‚îÇ
‚îú‚îÄ‚îÄ utils/ # –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —É—Ç–∏–ª–∏—Ç—ã
‚îÇ ‚îú‚îÄ‚îÄ prepare_data.py
‚îÇ ‚îî‚îÄ‚îÄ patch_upsell_links.py
‚îÇ
‚îú‚îÄ‚îÄ results/ # –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∏ –æ—Ç—á—ë—Ç—ã
‚îÇ ‚îú‚îÄ‚îÄ finetune_results.csv
‚îÇ ‚îú‚îÄ‚îÄ rag_results.csv
‚îÇ ‚îú‚îÄ‚îÄ comparison_summary.txt
‚îÇ ‚îú‚îÄ‚îÄ report.md
‚îÇ ‚îî‚îÄ‚îÄ ft_model.txt
‚îÇ
‚îú‚îÄ‚îÄ .env.example # –®–∞–±–ª–æ–Ω –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
‚îú‚îÄ‚îÄ .flake8 # –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ª–∏–Ω—Ç–µ—Ä–∞
‚îú‚îÄ‚îÄ requirements.txt # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
‚îú‚îÄ‚îÄ README.md # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø—Ä–æ–µ–∫—Ç–∞
‚îú‚îÄ‚îÄ compare.py # –°–∫—Ä–∏–ø—Ç —Å—Ä–∞–≤–Ω–µ–Ω–∏—è Fine-tune –∏ RAG
‚îî‚îÄ‚îÄ make_report.py # –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –∏—Ç–æ–≥–æ–≤–æ–≥–æ –æ—Ç—á—ë—Ç–∞ –≤ Markdown

---

## üß© –ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏
- **OpenAI API (GPT-4o-mini)** ‚Äî –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –∏ –¥–æ–æ–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏  
- **LangChain / FAISS / numpy / pandas** ‚Äî –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∏ —Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö  
- **Flake8** ‚Äî –∫–æ–Ω—Ç—Ä–æ–ª—å —á–∏—Å—Ç–æ—Ç—ã –∫–æ–¥–∞  
- **tabulate** ‚Äî –∫—Ä–∞—Å–∏–≤—ã–π Markdown-–≤—ã–≤–æ–¥ –æ—Ç—á—ë—Ç–∞  

---

## üß† –ö–∞–∫ –∑–∞–ø—É—Å—Ç–∏—Ç—å –ª–æ–∫–∞–ª—å–Ω–æ

```bash
# 1. –°–æ–∑–¥–∞—Ç—å –∏ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ
python -m venv .venv
.venv\Scripts\activate

# 2. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
pip install -r requirements.txt

# 3. –ü–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ
copy .env.example .env
# (–≤—Å—Ç–∞–≤–∏—Ç—å —Å–≤–æ–π OPENAI_API_KEY –≤ .env)
python utils/prepare_data.py

# 4. Fine-tuning
python finetune/train.py
python finetune/test.py

# 5. RAG
python -m rag.test

# 6. –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –∏ –æ—Ç—á—ë—Ç
python compare.py
python make_report.py


üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã

–ò—Ç–æ–≥–æ–≤—ã–π –æ—Ç—á—ë—Ç: results/report.md

Fine-tuning –∏ RAG —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–ª–∏—Å—å –Ω–∞ –ø—è—Ç–∏ –æ–¥–∏–Ω–∞–∫–æ–≤—ã—Ö –≤–æ–ø—Ä–æ—Å–∞—Ö.
–°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø–æ–∫–∞–∑–∞–ª–æ:

–ú–µ—Ç—Ä–∏–∫–∞	                    Fine-tune	    RAG
CTA (–º—è–≥–∫–∏–µ –ø—Ä–æ–¥–∞–∂–∏)	    1.0	            0.8
–°—Ç—Ä—É–∫—Ç—É—Ä–∞ (—Å–ø–∏—Å–∫–∏/–∞–±–∑–∞—Ü—ã)	0.8	            1.0
–ö—Ä–∞—Ç–∫–æ—Å—Ç—å/—Ç–æ—á–Ω–æ—Å—Ç—å	        1.0	            1.0
–°—É–º–º–∞—Ä–Ω—ã–π –±–∞–ª–ª	            1.8	            1.8

–í—ã–≤–æ–¥: Fine-tuning –¥–∞—ë—Ç –±–æ–ª–µ–µ —Å—Ç–∞–±–∏–ª—å–Ω—ã–π —Å—Ç–∏–ª—å –∏ –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ CTA,
RAG ‚Äî —Ç–æ—á–Ω–µ–µ –≤ —Ñ–∞–∫—Ç–∞—Ö –∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ.
üí° –û–ø—Ç–∏–º–∞–ª—å–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç ‚Äî –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≥–∏–±—Ä–∏–¥–Ω—ã–π –ø–æ–¥—Ö–æ–¥ (Fine-tuning + RAG).

üßë‚Äçüíª –ê–≤—Ç–æ—Ä

–°–∞—Ä–º–∞–Ω–æ–≤ –≠–¥—É–∞—Ä–¥ (–®–µ—Ñ)
–£—á–µ–±–Ω—ã–π –ø—Ä–æ–µ–∫—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω —Å–æ–≤–º–µ—Å—Ç–Ω–æ —Å —Ü–∏—Ñ—Ä–æ–≤—ã–º –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–æ–º –î–∂–∞—Ä–≤–∏—Å–æ–º ü§ñ